<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ product.name }} - Details</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body>
    <!-- Breadcrumb -->
    <nav>
        <a href="/">Home</a> > 
        <a href="/category/{{ product.category.id }}/">{{ product.category.name }}</a> > 
        {{ product.name }}
    </nav>

    <!-- Product Details -->
    <div class="product-detail">
        <h1>{{ product.name }}</h1>

        <!-- Images -->
        <div class="product-images">
            {% for variant in variants %}
                {% for image in variant.images.all %}
                    <img src="{{ image.image.url }}" alt="Image for {{ variant.name }}" class="zoomable">
                {% endfor %}
            {% endfor %}
        </div>

        <!-- Basic Information -->
        <p><strong>Brand:</strong> {{ product.brand.name }}</p>
        <p><strong>Connectivity:</strong> {{ product.get_connectivity_display }}</p>
        <p><strong>Type:</strong> {{ product.get_type_display }}</p>
        <p><strong>Price:</strong> 
            {% if product.discount %}
                <del>${{ variants.first.price }}</del>
                ${{ variants.first|get_discounted_price }}
            {% else %}
                ${{ variants.first.price }}
            {% endif %}
        </p>
        <p><strong>Stock:</strong> 
            {% if variants.first.stock > 0 %}
                In Stock ({{ variants.first.stock }} available)
            {% else %}
                Out of Stock
            {% endif %}
        </p>

        <!-- Highlights/Specs -->
        <div class="highlights">
            <h3>Highlights</h3>
            <ul>
                <li>{{ product.description }}</li>
                <!-- Add more highlights if available -->
            </ul>
        </div>

        <!-- Reviews -->
        <div class="reviews">
            <h3>Customer Reviews</h3>
            {% for review in reviews %}
                <div class="review">
                    <strong>{{ review.user.fullname }}</strong>
                    <p>Rating: {{ review.rating }}/5</p>
                    <p>{{ review.review_text }}</p>
                </div>
            {% empty %}
                <p>No reviews yet. Be the first to review this product!</p>
            {% endfor %}
        </div>
    </div>

    <!-- Related Products -->
    <div class="related-products">
        <h3>Related Products</h3>
        <div class="related-items">
            {% for related in related_products %}
                <div class="related-item">
                    <a href="{% url 'product_detail' related.id %}">
                        <img src="{{ related.variants.first.images.first.image.url }}" alt="{{ related.name }}">
                        <h4>{{ related.name }}</h4>
                        <p>${{ related.variants.first.price }}</p>
                    </a>
                </div>
            {% endfor %}
        </div>
    </div>

    <script src="{% static 'js/zoom.js' %}"></script>
</body>
</html>
